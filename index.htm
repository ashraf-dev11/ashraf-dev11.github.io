<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .page { display: none; animation: fadeIn 0.5s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .nav-active { background: rgba(255, 255, 255, 0.1); border-radius: 8px; }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 font-cairo">
    
    <!-- Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="app">
        <!-- Header -->
        <header class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="flex items-center space-x-3 space-x-reverse mb-4 md:mb-0">
                        <div class="bg-white p-2 rounded-full">
                            <i class="fas fa-dumbbell text-blue-500 text-2xl"></i>
                        </div>
                        <div>
                            <h1 class="text-2xl md:text-3xl font-bold">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</h1>
                            <p class="text-blue-100 text-sm">Ø®Ø·Ø· Ù…Ø®ØµØµØ© Ù„Ùƒ</p>
                        </div>
                    </div>
                    
                    <nav class="flex space-x-2 space-x-reverse">
                        <button onclick="switchPage('calculator')" class="nav-item px-4 py-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200 nav-active">
                            <i class="fas fa-calculator ml-2"></i>Ø§Ù„Ø­Ø§Ø³Ø¨Ø©
                        </button>
                        <button onclick="switchPage('meal-plan')" class="nav-item px-4 py-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">
                            <i class="fas fa-utensils ml-2"></i>Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ©
                        </button>
                        <button onclick="switchPage('workout')" class="nav-item px-4 py-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">
                            <i class="fas fa-dumbbell ml-2"></i>Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†
                        </button>
                    </nav>
                </div>
            </div>
        </header>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <main class="container mx-auto px-4 py-8">
            <!-- ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© -->
            <section id="calculator-page" class="page active">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-dark mb-4">Ø§Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
                    <p class="text-gray-600 max-w-2xl mx-auto">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·Ø· Ù…ØªÙƒØ§Ù…Ù„Ø©</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <div class="flex items-center mb-6">
                            <div class="bg-blue-500 p-3 rounded-full ml-4">
                                <i class="fas fa-user text-white text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-dark">Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
                        </div>
                        
                        <form id="calculatorForm" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…)</label>
                                    <input type="number" id="weight" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20" placeholder="Ù…Ø«Ø§Ù„: 75" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)</label>
                                    <input type="number" id="height" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20" placeholder="Ù…Ø«Ø§Ù„: 175" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ø§Ù„Ø¹Ù…Ø± (Ø³Ù†Ø©)</label>
                                    <input type="number" id="age" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20" placeholder="Ù…Ø«Ø§Ù„: 25" required>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ø§Ù„Ø¬Ù†Ø³</label>
                                    <div class="flex space-x-4 space-x-reverse">
                                        <label class="flex items-center space-x-2 space-x-reverse cursor-pointer">
                                            <input type="radio" name="gender" value="male" checked class="text-blue-500">
                                            <span>Ø°ÙƒØ±</span>
                                        </label>
                                        <label class="flex items-center space-x-2 space-x-reverse cursor-pointer">
                                            <input type="radio" name="gender" value="female" class="text-blue-500">
                                            <span>Ø£Ù†Ø«Ù‰</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</label>
                                    <select id="goal" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20">
                                        <option value="cutting">ØªÙ†Ø´ÙŠÙ ÙˆØ­Ø±Ù‚ Ø§Ù„Ø¯Ù‡ÙˆÙ†</option>
                                        <option value="bulking">ØªØ¶Ø®ÙŠÙ… ÙˆØ¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ø¶Ù„Ø§Øª</option>
                                        <option value="maintain" selected>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ø£ÙŠØ§Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹</label>
                                    <select id="workoutDays" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20">
                                        <option value="3">3 Ø£ÙŠØ§Ù…</option>
                                        <option value="4" selected>4 Ø£ÙŠØ§Ù…</option>
                                        <option value="5">5 Ø£ÙŠØ§Ù…</option>
                                        <option value="6">6 Ø£ÙŠØ§Ù…</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø©</label>
                                    <select id="planType" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20">
                                        <option value="normal">Ø£ÙŠØ§Ù… Ø¹Ø§Ø¯ÙŠØ©</option>
                                        <option value="ramadan">Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù†</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</label>
                                    <select id="workoutSystem" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20">
                                        <option value="bro_split">Ø¨Ø±Ùˆ Ø³Ø¨Ù„Øª</option>
                                        <option value="push_pull_legs">Ø¨ÙˆØ´ Ø¨ÙˆÙ„ Ù„ÙŠØ¬</option>
                                        <option value="arnold_split">Ø£Ø±Ù†ÙˆÙ„Ø¯ Ø³Ø¨Ù„Øª</option>
                                        <option value="full_body">ÙƒØ§Ù…Ù„ Ø§Ù„Ø¬Ø³Ù…</option>
                                    </select>
                                </div>
                            </div>
                            
                            <button type="submit" class="w-full gradient-bg hover:opacity-90 text-white font-bold py-4 px-6 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
                                <i class="fas fa-bolt ml-2"></i> Ø§Ø­Ø³Ø¨ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·Ø©
                            </button>
                        </form>
                    </div>
                    
                    <!-- Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <div class="flex items-center mb-6">
                            <div class="bg-green-500 p-3 rounded-full ml-4">
                                <i class="fas fa-chart-line text-white text-xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-dark">Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
                        </div>
                        
                        <div id="results" class="space-y-6">
                            <div class="text-center py-12">
                                <div class="text-6xl mb-4">ğŸ“Š</div>
                                <p class="text-gray-500 text-lg">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ø­Ø³Ø¨ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·Ø©"</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- ØµÙØ­Ø© Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ© -->
            <section id="meal-plan-page" class="page">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-dark mb-4">Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h2>
                    <p class="text-gray-600 max-w-2xl mx-auto">ÙˆØ¬Ø¨Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø© Ù„Ù…Ø¯Ø© 30 ÙŠÙˆÙ…</p>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                    <div class="p-8 border-b border-gray-100">
                        <div class="flex flex-col md:flex-row justify-between items-center">
                            <div>
                                <h3 class="text-2xl font-bold text-dark mb-2">Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
                            </div>
                            <div class="flex space-x-4 space-x-reverse mt-6 md:mt-0">
                                <button id="prevWeek" class="px-5 py-2 border-2 border-gray-200 rounded-xl hover:bg-gray-50 transition-colors duration-200">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                                <span id="weekDisplay" class="px-6 py-2 font-bold text-lg text-dark">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 1</span>
                                <button id="nextWeek" class="px-5 py-2 border-2 border-gray-200 rounded-xl hover:bg-gray-50 transition-colors duration-200">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-8" id="mealPlanContent">
                        <div class="text-center py-16">
                            <div class="text-6xl mb-4">ğŸ½ï¸</div>
                            <p class="text-gray-500 text-lg">ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹</p>
                            <button onclick="switchPage('calculator')" class="mt-6 gradient-bg hover:opacity-90 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
                                Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø­Ø§Ø³Ø¨Ø©
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- ØµÙØ­Ø© Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† -->
            <section id="workout-page" class="page">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-dark mb-4">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</h2>
                    <p class="text-gray-600 max-w-2xl mx-auto">ØªÙ…Ø§Ø±ÙŠÙ† Ù…Ø®ØµØµØ© Ù„Ø£Ù‡Ø¯Ø§ÙÙƒ</p>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-8">
                    <div id="workoutPlanContent">
                        <div class="text-center py-16">
                            <div class="text-6xl mb-4">ğŸ’ª</div>
                            <p class="text-gray-500 text-lg">ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹</p>
                            <button onclick="switchPage('calculator')" class="mt-6 gradient-bg hover:opacity-90 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
                                Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø­Ø§Ø³Ø¨Ø©
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-12 mt-16">
            <div class="container mx-auto px-4 text-center">
                <div class="flex flex-col items-center mb-8">
                    <div class="bg-white p-3 rounded-full mb-4">
                        <i class="fas fa-dumbbell text-blue-500 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</h3>
                    <p class="text-gray-400 max-w-md">Ø®Ø·Ø· ØªØºØ°ÙŠØ© ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ù…Ø®ØµØµØ©</p>
                </div>
                
                <div class="border-t border-gray-700 pt-8 text-gray-400">
                    <p>Â© 2024 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ - Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®Ø²Ù†Ø©
        let userData = null;
        let currentWeek = 1;
        
        // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });
        
        function setupEventListeners() {
            // Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©
            const calculatorForm = document.getElementById('calculatorForm');
            if (calculatorForm) {
                calculatorForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    await calculate();
                });
            }
            
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹
            document.getElementById('prevWeek')?.addEventListener('click', function() {
                if (currentWeek > 1) {
                    currentWeek--;
                    updateWeekDisplay();
                    if (userData) generateMealPlan();
                }
            });
            
            document.getElementById('nextWeek')?.addEventListener('click', function() {
                if (currentWeek < 4) {
                    currentWeek++;
                    updateWeekDisplay();
                    if (userData) generateMealPlan();
                }
            });
        }
        
        async function calculate() {
            // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            const age = parseInt(document.getElementById('age').value);
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const goal = document.getElementById('goal').value;
            const workoutDays = document.getElementById('workoutDays').value;
            const planType = document.getElementById('planType').value;
            const workoutSystem = document.getElementById('workoutSystem').value;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!weight || !height || !age) {
                showMessage('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            const submitBtn = document.querySelector('#calculatorForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<div class="loading"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...';
            submitBtn.disabled = true;
            
            try {
                // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                const prompt = `
                    Ù…Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§ØªÙ‡:
                    Ø§Ù„ÙˆØ²Ù†: ${weight} ÙƒØ¬Ù…
                    Ø§Ù„Ø·ÙˆÙ„: ${height} Ø³Ù…
                    Ø§Ù„Ø¹Ù…Ø±: ${age} Ø³Ù†Ø©
                    Ø§Ù„Ø¬Ù†Ø³: ${gender === 'male' ? 'Ø°ÙƒØ±' : 'Ø£Ù†Ø«Ù‰'}
                    Ø§Ù„Ù‡Ø¯Ù: ${goal === 'cutting' ? 'ØªÙ†Ø´ÙŠÙ' : goal === 'bulking' ? 'ØªØ¶Ø®ÙŠÙ…' : 'Ù…Ø­Ø§ÙØ¸Ø©'}
                    Ø£ÙŠØ§Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ†: ${workoutDays} ÙŠÙˆÙ… Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹
                    Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø©: ${planType === 'ramadan' ? 'Ø±Ù…Ø¶Ø§Ù†' : 'Ø¹Ø§Ø¯ÙŠ'}
                    Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†: ${workoutSystem}
                    
                    Ø£Ø±Ø¬Ùˆ Ø­Ø³Ø§Ø¨:
                    1. Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                    2. Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ† Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¨Ø§Ù„Ø¬Ø±Ø§Ù…
                    3. Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø¨Ø§Ù„Ø¬Ø±Ø§Ù…
                    4. Ø§Ù„Ø¯Ù‡ÙˆÙ† Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø¨Ø§Ù„Ø¬Ø±Ø§Ù…
                    5. ØªÙ‚Ø¯ÙŠÙ… Ù†ØµÙŠØ­Ø© Ù…Ø®ØªØµØ±Ø©
                    
                    Ø§Ù„Ø±Ø¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ØªÙ†Ø³ÙŠÙ‚ JSON ÙÙ‚Ø·:
                    {
                        "calories": Ø±Ù‚Ù…,
                        "protein": Ø±Ù‚Ù…,
                        "carbs": Ø±Ù‚Ù…,
                        "fat": Ø±Ù‚Ù…,
                        "tdee": Ø±Ù‚Ù…,
                        "bmr": Ø±Ù‚Ù…,
                        "recommendations": "Ù†ØµÙŠØ­Ø©"
                    }
                `;
                
                const aiResponse = await callAPI(prompt);
                
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
                let aiData;
                try {
                    const jsonMatch = aiResponse.match(/\{[\s\S]*\}/);
                    aiData = JSON.parse(jsonMatch ? jsonMatch[0] : aiResponse);
                } catch (e) {
                    // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø­Ø³Ø§Ø¨ Ø£Ø³Ø§Ø³ÙŠ
                    aiData = calculateBasic(weight, height, age, gender, goal, workoutDays, planType);
                }
                
                // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                userData = {
                    weight: weight,
                    height: height,
                    age: age,
                    gender: gender,
                    goal: goal,
                    workoutDays: workoutDays,
                    planType: planType,
                    workoutSystem: workoutSystem,
                    calories: parseInt(aiData.calories) || 2000,
                    protein: parseInt(aiData.protein) || 100,
                    carbs: parseInt(aiData.carbs) || 250,
                    fat: parseInt(aiData.fat) || 65,
                    tdee: parseInt(aiData.tdee) || 2200,
                    bmr: parseInt(aiData.bmr) || 1700,
                    recommendations: aiData.recommendations || "ØªÙ†Ø§ÙˆÙ„ ØºØ°Ø§Ø¡ Ù…ØªÙˆØ§Ø²Ù†"
                };
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                displayResults(userData);
                
                showMessage('ØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('Error:', error);
                showMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨', 'error');
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø­Ø³Ø§Ø¨ Ø£Ø³Ø§Ø³ÙŠ ÙƒØ¨Ø¯ÙŠÙ„
                userData = calculateBasic(weight, height, age, gender, goal, workoutDays, planType);
                userData.workoutSystem = workoutSystem;
                displayResults(userData);
                
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }
        
        async function callAPI(prompt) {
            try {
                const apiKey = "AIzaSyBAZX-U_9ZIBsYAYOYaoI3iO7-qeEeOCVk";
                const apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";
                
                const response = await fetch(`${apiUrl}?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 1000
                        }
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${response.status}`);
                }
                
                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
                
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }
        
        function calculateBasic(weight, height, age, gender, goal, workoutDays, planType) {
            // Ø­Ø³Ø§Ø¨ Ø¨Ø³ÙŠØ·
            let bmr;
            if (gender === "male") {
                bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
            } else {
                bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
            }
            
            const activity = parseFloat(workoutDays) >= 5 ? 1.725 : 1.55;
            let tdee = Math.round(bmr * activity);
            
            let calories, protein;
            switch(goal) {
                case "cutting":
                    calories = tdee * 0.85;
                    protein = weight * 2.2;
                    break;
                case "bulking":
                    calories = tdee * 1.15;
                    protein = weight * 1.8;
                    break;
                default:
                    calories = tdee;
                    protein = weight * 1.6;
            }
            
            if (planType === "ramadan") {
                calories *= 0.9;
            }
            
            const fat = Math.round((calories * 0.25) / 9);
            const carbs = Math.round((calories - (protein * 4) - (fat * 9)) / 4);
            
            return {
                calories: Math.round(calories),
                protein: Math.round(protein),
                carbs: carbs,
                fat: fat,
                tdee: tdee,
                bmr: Math.round(bmr),
                recommendations: "Ø§Ø­Ø±Øµ Ø¹Ù„Ù‰ ØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø·Ø¹Ø§Ù… Ø§Ù„ØµØ­ÙŠ ÙˆÙ…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ù…"
            };
        }
        
        async function generateMealPlan() {
            if (!userData) {
                showMessage('ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                switchPage('calculator');
                return;
            }
            
            const mealPlanContent = document.getElementById('mealPlanContent');
            updateWeekDisplay();
            
            // Ø¹Ø±Ø¶ ØªØ­Ù…ÙŠÙ„
            mealPlanContent.innerHTML = `
                <div class="text-center py-12">
                    <div class="loading mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                    <p class="text-gray-600 text-lg">Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ©...</p>
                </div>
            `;
            
            try {
                const days = ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©"];
                let weeklyPlan = "";
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ù„ÙƒÙ„ ÙŠÙˆÙ…
                for (let dayIndex = 0; dayIndex < 7; dayIndex++) {
                    const dayName = days[dayIndex];
                    const isRamadan = userData.planType === "ramadan";
                    
                    const prompt = `
                        Ø£Ù†Ø´Ø¦ Ø®Ø·Ø© ÙˆØ¬Ø¨Ø§Øª Ù„ÙŠÙˆÙ… ${dayName}:
                        Ø§Ù„Ø³Ø¹Ø±Ø§Øª: ${userData.calories}
                        Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†: ${userData.protein}Øº
                        Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª: ${userData.carbs}Øº
                        Ø§Ù„Ø¯Ù‡ÙˆÙ†: ${userData.fat}Øº
                        Ø§Ù„Ù‡Ø¯Ù: ${userData.goal === 'cutting' ? 'ØªÙ†Ø´ÙŠÙ' : userData.goal === 'bulking' ? 'ØªØ¶Ø®ÙŠÙ…' : 'Ù…Ø­Ø§ÙØ¸Ø©'}
                        ${isRamadan ? 'ÙÙŠ Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† (Ø¥ÙØ·Ø§Ø± ÙˆØ³Ø­ÙˆØ±)' : 'Ø£ÙŠØ§Ù… Ø¹Ø§Ø¯ÙŠØ© (ÙØ·ÙˆØ±ØŒ ØºØ¯Ø§Ø¡ØŒ Ø¹Ø´Ø§Ø¡)'}
                        
                        Ø£Ø±Ø¬Ùˆ ØªÙ‚Ø¯ÙŠÙ… ÙˆØ¬Ø¨Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø© Ù…Ø¹ Ø§Ù„ÙƒÙ…ÙŠØ§Øª.
                    `;
                    
                    try {
                        const dayPlan = await callAPI(prompt);
                        weeklyPlan += `
                            <div class="bg-gray-50 rounded-2xl p-6 mb-6">
                                <h4 class="text-xl font-bold text-dark mb-4 pb-3 border-b border-gray-200">${dayName} - Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${currentWeek}</h4>
                                <div class="text-gray-700">
                                    ${formatResponse(dayPlan)}
                                </div>
                            </div>
                        `;
                    } catch (error) {
                        weeklyPlan += `
                            <div class="bg-gray-50 rounded-2xl p-6 mb-6">
                                <h4 class="text-xl font-bold text-dark mb-4 pb-3 border-b border-gray-200">${dayName} - Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${currentWeek}</h4>
                                <div class="text-gray-700">
                                    <p>Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… Ù‚Ø±ÙŠØ¨Ø§Ù‹.</p>
                                    <p class="text-gray-500 text-sm mt-2">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>
                                </div>
                            </div>
                        `;
                    }
                }
                
                mealPlanContent.innerHTML = `
                    <div class="space-y-8">
                        ${weeklyPlan}
                    </div>
                `;
                
            } catch (error) {
                console.error('Error:', error);
                mealPlanContent.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ğŸ˜•</div>
                        <p class="text-gray-600 text-lg">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ©</p>
                        <button onclick="generateMealPlan()" class="mt-4 gradient-bg hover:opacity-90 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200">
                            Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                        </button>
                    </div>
                `;
            }
        }
        
        async function generateWorkoutPlan() {
            if (!userData) {
                showMessage('ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                switchPage('calculator');
                return;
            }
            
            const workoutPlanContent = document.getElementById('workoutPlanContent');
            
            // Ø¹Ø±Ø¶ ØªØ­Ù…ÙŠÙ„
            workoutPlanContent.innerHTML = `
                <div class="text-center py-12">
                    <div class="loading mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                    <p class="text-gray-600 text-lg">Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†...</p>
                </div>
            `;
            
            try {
                const prompt = `
                    Ø£Ù†Ø´Ø¦ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªÙ…Ø§Ø±ÙŠÙ† ${userData.workoutSystem} Ù„Ù€ ${userData.workoutDays} Ø£ÙŠØ§Ù… Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹.
                    Ø§Ù„Ù‡Ø¯Ù: ${userData.goal === 'cutting' ? 'ØªÙ†Ø´ÙŠÙ' : userData.goal === 'bulking' ? 'ØªØ¶Ø®ÙŠÙ…' : 'Ù…Ø­Ø§ÙØ¸Ø©'}
                    Ø§Ù„ÙˆØ²Ù†: ${userData.weight} ÙƒØ¬Ù…
                    
                    Ø£Ø±Ø¬Ùˆ ØªÙ‚Ø¯ÙŠÙ…:
                    1. Ø¬Ø¯ÙˆÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠ ÙƒØ§Ù…Ù„
                    2. Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ù„ÙƒÙ„ ÙŠÙˆÙ… Ù…Ø¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ÙˆØ§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª
                    3. Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªÙ…Ø±ÙŠÙ†
                `;
                
                const response = await callAPI(prompt);
                
                workoutPlanContent.innerHTML = `
                    <div class="space-y-8">
                        <div class="text-gray-700">
                            ${formatResponse(response)}
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('Error:', error);
                workoutPlanContent.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ğŸ˜•</div>
                        <p class="text-gray-600 text-lg">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</p>
                        <button onclick="generateWorkoutPlan()" class="mt-4 gradient-bg hover:opacity-90 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200">
                            Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                        </button>
                    </div>
                `;
            }
        }
        
        function formatResponse(response) {
            return response
                .replace(/\*\*(.*?)\*\*/g, '<strong class="text-blue-600">$1</strong>')
                .replace(/\n\n/g, '</p><p class="mt-4">')
                .replace(/\n/g, '<br>');
        }
        
        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            if (!resultsDiv) return;
            
            const goalText = data.goal === "cutting" ? "ØªÙ†Ø´ÙŠÙ" : data.goal === "bulking" ? "ØªØ¶Ø®ÙŠÙ…" : "Ù…Ø­Ø§ÙØ¸Ø©";
            
            resultsDiv.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-blue-50 p-4 rounded-xl text-center">
                        <div class="text-2xl font-bold text-blue-600 mb-2">${data.calories}</div>
                        <div class="text-gray-600">Ø³Ø¹Ø±Ø© Ø­Ø±Ø§Ø±ÙŠØ©</div>
                        <div class="text-sm text-gray-500 mt-1">ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-xl text-center">
                        <div class="text-2xl font-bold text-green-600 mb-2">${data.protein} Øº</div>
                        <div class="text-gray-600">Ø¨Ø±ÙˆØªÙŠÙ†</div>
                        <div class="text-sm text-gray-500 mt-1">ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                    </div>
                    
                    <div class="bg-yellow-50 p-4 rounded-xl text-center">
                        <div class="text-2xl font-bold text-yellow-600 mb-2">${data.carbs} Øº</div>
                        <div class="text-gray-600">ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª</div>
                        <div class="text-sm text-gray-500 mt-1">ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                    </div>
                    
                    <div class="bg-purple-50 p-4 rounded-xl text-center">
                        <div class="text-2xl font-bold text-purple-600 mb-2">${data.fat} Øº</div>
                        <div class="text-gray-600">Ø¯Ù‡ÙˆÙ†</div>
                        <div class="text-sm text-gray-500 mt-1">ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-xl text-center">
                        <div class="text-2xl font-bold text-gray-700 mb-2">${data.tdee}</div>
                        <div class="text-gray-600">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ÙØ§Ù‚</div>
                        <div class="text-sm text-gray-500 mt-1">TDEE</div>
                    </div>
                    
                    <div class="bg-red-50 p-4 rounded-xl text-center">
                        <div class="text-2xl font-bold text-red-600 mb-2">${data.bmr}</div>
                        <div class="text-gray-600">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø£ÙŠØ¶</div>
                        <div class="text-sm text-gray-500 mt-1">BMR</div>
                    </div>
                </div>
                
                <div class="bg-gray-50 rounded-xl p-6">
                    <h4 class="font-bold text-dark mb-4">Ø§Ù„ØªÙˆØµÙŠØ§Øª:</h4>
                    <p class="text-gray-700">${data.recommendations}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-blue-500 rounded-full ml-2"></div>
                            <span>Ø§Ù„Ù‡Ø¯Ù: <span class="font-bold">${goalText}</span></span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-green-500 rounded-full ml-2"></div>
                            <span>Ø£ÙŠØ§Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ†: <span class="font-bold">${data.workoutDays} ÙŠÙˆÙ…</span></span>
                        </div>
                    </div>
                </div>
                
                <div class="text-center pt-6">
                    <button onclick="switchPage('meal-plan')" class="gradient-bg hover:opacity-90 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
                        <i class="fas fa-arrow-left ml-2"></i> Ø´Ø§Ù‡Ø¯ Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ©
                    </button>
                </div>
            `;
        }
        
        function switchPage(pageName) {
            // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('nav-active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const pageElement = document.getElementById(`${pageName}-page`);
            if (pageElement) {
                pageElement.classList.add('active');
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                const activeButton = Array.from(document.querySelectorAll('.nav-item')).find(btn => 
                    btn.getAttribute('onclick')?.includes(`'${pageName}'`)
                );
                if (activeButton) {
                    activeButton.classList.add('nav-active');
                }
                
                // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª
                if (userData) {
                    if (pageName === 'meal-plan') {
                        generateMealPlan();
                    } else if (pageName === 'workout') {
                        generateWorkoutPlan();
                    }
                }
            }
        }
        
        function updateWeekDisplay() {
            const weekDisplay = document.getElementById('weekDisplay');
            if (weekDisplay) {
                weekDisplay.textContent = `Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${currentWeek}`;
            }
        }
        
        function showMessage(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-xl shadow-lg text-white font-bold ${
                type === 'success' ? 'bg-green-500' : 'bg-red-500'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø©
        window.switchPage = switchPage;
        window.generateMealPlan = generateMealPlan;
        window.generateWorkoutPlan = generateWorkoutPlan;
    </script>
</body>
</html>

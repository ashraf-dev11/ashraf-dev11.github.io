<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitness AI - ุชุทุจูู ุงูููุงูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</title>
    
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .card { background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .btn-primary { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; border: none; }
        .btn-primary:hover { opacity: 0.9; transform: translateY(-2px); }
        .fade-in { animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body class="text-gray-800">

<!-- App Container -->
<div class="container mx-auto px-4 py-8 max-w-6xl">
    
    <!-- Header -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-white mb-4">๐๏ธโโ๏ธ Fitness AI</h1>
        <p class="text-white/80 text-lg">ุชุทุจูู ุงูููุงูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</p>
    </div>

    <!-- Main Card -->
    <div class="card p-8 fade-in">
        <!-- Login Section -->
        <div id="loginSection">
            <h2 class="text-2xl font-bold mb-6 text-center">๐ ุชุณุฌูู ุงูุฏุฎูู</h2>
            
            <div class="space-y-4 max-w-md mx-auto">
                <div>
                    <label class="block mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="emailInput" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="example@gmail.com">
                </div>
                
                <div>
                    <label class="block mb-2">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="passwordInput" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="********">
                </div>
                
                <div class="flex gap-3">
                    <button onclick="signIn()" class="btn-primary flex-1 p-3 rounded-lg font-bold">
                        <i class="fas fa-sign-in-alt ml-2"></i> ุฏุฎูู
                    </button>
                    <button onclick="signUp()" class="bg-green-600 hover:bg-green-700 text-white flex-1 p-3 rounded-lg font-bold">
                        <i class="fas fa-user-plus ml-2"></i> ุญุณุงุจ ุฌุฏูุฏ
                    </button>
                </div>
                
                <div class="text-center">
                    <button onclick="resetPassword()" class="text-blue-600 hover:text-blue-800">
                        ูุณูุช ูููุฉ ุงููุฑูุฑุ
                    </button>
                </div>
            </div>
            
            <div class="mt-8 grid grid-cols-3 gap-4">
                <div class="text-center p-4 bg-blue-50 rounded-xl">
                    <div class="text-blue-500 text-2xl mb-2"><i class="fas fa-brain"></i></div>
                    <p class="font-bold">ุฐูุงุก ุงุตุทูุงุนู</p>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-xl">
                    <div class="text-green-500 text-2xl mb-2"><i class="fas fa-calendar-alt"></i></div>
                    <p class="font-bold">ุฎุทุท ุดูุฑูุฉ</p>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-xl">
                    <div class="text-purple-500 text-2xl mb-2"><i class="fas fa-chart-line"></i></div>
                    <p class="font-bold">ูุชุงุจุนุฉ ุฐููุฉ</p>
                </div>
            </div>
        </div>

        <!-- Profile Form -->
        <div id="profileSection" class="hidden">
            <h2 class="text-2xl font-bold mb-6 text-center">๐ ุจูุงูุงุชู ุงูุดุฎุตูุฉ</h2>
            
            <div class="space-y-4 max-w-2xl mx-auto">
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block mb-2">ุงูุงุณู</label>
                        <input type="text" id="nameInput" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="ุฃุญูุฏ ูุญูุฏ">
                    </div>
                    <div>
                        <label class="block mb-2">ุงูุนูุฑ</label>
                        <input type="number" id="ageInput" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="25">
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block mb-2">ุงููุฒู (ูุฌู)</label>
                        <input type="number" id="weightInput" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="75">
                    </div>
                    <div>
                        <label class="block mb-2">ุงูุทูู (ุณู)</label>
                        <input type="number" id="heightInput" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="175">
                    </div>
                </div>
                
                <div>
                    <label class="block mb-2">ุงููุฏู</label>
                    <select id="goalInput" class="w-full p-3 border border-gray-300 rounded-lg">
                        <option value="weight_loss">๐ฅ ุฎุณุงุฑุฉ ุงููุฒู</option>
                        <option value="muscle_gain" selected>๐ช ุจูุงุก ุงูุนุถูุงุช</option>
                        <option value="fitness">๐ ุชุญุณูู ุงูููุงูุฉ</option>
                    </select>
                </div>
                
                <div>
                    <label class="block mb-2">ูุณุชูู ุงููุดุงุท</label>
                    <select id="activityInput" class="w-full p-3 border border-gray-300 rounded-lg">
                        <option value="sedentary">๐บ ูููู ุงูุญุฑูุฉ</option>
                        <option value="light">๐ถ ุฎููู</option>
                        <option value="moderate" selected>๐ช ูุชูุณุท</option>
                        <option value="active">๐ฅ ูุดูุท</option>
                    </select>
                </div>
                
                <button onclick="generatePlan()" class="w-full btn-primary p-4 rounded-xl text-lg font-bold pulse">
                    <i class="fas fa-robot ml-2"></i> ุฃูุดุฆ ุฎุทุชู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
                </button>
            </div>
        </div>

        <!-- Loading -->
        <div id="loadingSection" class="hidden text-center">
            <div class="py-12">
                <div class="w-20 h-20 border-4 border-blue-200 rounded-full mx-auto mb-6 relative">
                    <div class="absolute top-0 left-0 w-20 h-20 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-2xl">๐ค</div>
                </div>
                
                <h3 class="text-xl font-bold mb-4">DeepSeek AI ูุตูู ุฎุทุชู</h3>
                <p class="text-gray-600 mb-6">ุฌุงุฑู ุชุญููู ุจูุงูุงุชู ูุฅูุดุงุก ุฎุทุฉ ุดูุฑูุฉ</p>
                
                <div class="space-y-2 max-w-md mx-auto">
                    <div class="flex justify-between items-center">
                        <span>ุชุญููู ุงูุจูุงูุงุช</span>
                        <i class="fas fa-check text-green-500" id="step1"></i>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>ุชุตููู ุงูุชูุงุฑูู</span>
                        <i class="fas fa-check text-green-500 hidden" id="step2"></i>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>ุฅูุดุงุก ุงููุธุงู ุงูุบุฐุงุฆู</span>
                        <i class="fas fa-check text-green-500 hidden" id="step3"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Results -->
        <div id="resultsSection" class="hidden">
            <h2 class="text-2xl font-bold mb-6 text-center">๐ฏ ุฎุทุชู ุงูุฐููุฉ</h2>
            
            <div id="aiPlan" class="bg-gray-50 p-6 rounded-xl mb-6">
                <!-- ุณูุชู ุชุนุจุฆุชูุง ุจุงูุฎุทุฉ -->
            </div>
            
            <div class="border-t pt-6">
                <h3 class="text-xl font-bold mb-4">๐ฌ ุงุณุฃู ุงูุฐูุงุก ุงูุงุตุทูุงุนู</h3>
                
                <div class="flex gap-3 mb-4">
                    <input type="text" id="questionInput" class="flex-1 p-3 border border-gray-300 rounded-lg" placeholder="ุงุณุฃู ุนู ุฃู ุดูุก ูู ุฎุทุชู...">
                    <button onclick="askAI()" class="btn-primary px-6 rounded-lg font-bold">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                
                <div id="chatHistory" class="space-y-4 max-h-60 overflow-y-auto p-4">
                    <!-- ุงููุญุงุฏุซุฉ ุชุธูุฑ ููุง -->
                </div>
                
                <div class="mt-6 flex gap-3">
                    <button onclick="showSection('profile')" class="flex-1 bg-gray-200 hover:bg-gray-300 p-3 rounded-lg">
                        <i class="fas fa-redo ml-2"></i> ุฎุทุฉ ุฌุฏูุฏุฉ
                    </button>
                    <button onclick="downloadPlan()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg">
                        <i class="fas fa-download ml-2"></i> ุชุญููู ุงูุฎุทุฉ
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <div class="text-center mt-8 text-white/60">
        <p>Powered by DeepSeek AI & Firebase | GitHub Pages</p>
    </div>
</div>

<!-- Firebase & AI Integration -->
<script>
// ========== CONFIGURATION ==========
const FIREBASE_CONFIG = {
    apiKey: "AIzaSyCrOyz_5uc63XPhCD_S7WwtAx6CfgcxbTk",
    authDomain: "fitness-app-users-c71e4.firebaseapp.com",
    projectId: "fitness-app-users-c71e4",
    storageBucket: "fitness-app-users-c71e4.firebasestorage.app",
    messagingSenderId: "631538722348",
    appId: "1:631538722348:web:0bdb2bb79d351c072a1389"
};

const DEEPSEEK_API_KEY = "sk-89757c271e8347c0a74bd3ea46fb52a3";

// ========== INITIALIZE FIREBASE ==========
firebase.initializeApp(FIREBASE_CONFIG);
const auth = firebase.auth();
const db = firebase.firestore();

// ========== STATE ==========
let currentUser = null;
let userProfile = null;
let aiPlan = null;

// ========== AUTHENTICATION ==========
auth.onAuthStateChanged((user) => {
    currentUser = user;
    if (user) {
        showSection('profile');
        loadUserData();
    } else {
        showSection('login');
    }
});

function signIn() {
    const email = document.getElementById('emailInput').value;
    const password = document.getElementById('passwordInput').value;
    
    if (!email || !password) {
        alert('ุฃุฏุฎู ุงูุจุฑูุฏ ููููุฉ ุงููุฑูุฑ');
        return;
    }
    
    auth.signInWithEmailAndPassword(email, password)
        .catch(error => alert('ุฎุทุฃ: ' + error.message));
}

function signUp() {
    const email = document.getElementById('emailInput').value;
    const password = document.getElementById('passwordInput').value;
    
    if (!email || !password) {
        alert('ุฃุฏุฎู ุงูุจุฑูุฏ ููููุฉ ุงููุฑูุฑ');
        return;
    }
    
    if (password.length < 6) {
        alert('ูููุฉ ุงููุฑูุฑ 6 ุฃุญุฑู ุนูู ุงูุฃูู');
        return;
    }
    
    auth.createUserWithEmailAndPassword(email, password)
        .then(() => {
            alert('ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ!');
        })
        .catch(error => alert('ุฎุทุฃ: ' + error.message));
}

function resetPassword() {
    const email = document.getElementById('emailInput').value;
    if (!email) {
        alert('ุฃุฏุฎู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู');
        return;
    }
    
    auth.sendPasswordResetEmail(email)
        .then(() => alert('ุชู ุฅุฑุณุงู ุฑุงุจุท ุฅุนุงุฏุฉ ุงูุชุนููู'))
        .catch(error => alert('ุฎุทุฃ: ' + error.message));
}

// ========== UI MANAGEMENT ==========
function showSection(section) {
    const sections = ['login', 'profile', 'loading', 'results'];
    sections.forEach(s => {
        document.getElementById(s + 'Section').classList.add('hidden');
    });
    document.getElementById(section + 'Section').classList.remove('hidden');
}

// ========== USER PROFILE ==========
async function loadUserData() {
    if (!currentUser) return;
    
    try {
        const doc = await db.collection('users').doc(currentUser.uid).get();
        if (doc.exists) {
            userProfile = doc.data();
            document.getElementById('nameInput').value = userProfile.name || '';
            document.getElementById('ageInput').value = userProfile.age || '';
            document.getElementById('weightInput').value = userProfile.weight || '';
            document.getElementById('heightInput').value = userProfile.height || '';
        }
    } catch (error) {
        console.error('Error loading user data:', error);
    }
}

// ========== AI PLAN GENERATION ==========
async function generatePlan() {
    // ุฌูุน ุงูุจูุงูุงุช
    userProfile = {
        name: document.getElementById('nameInput').value,
        age: document.getElementById('ageInput').value,
        weight: document.getElementById('weightInput').value,
        height: document.getElementById('heightInput').value,
        goal: document.getElementById('goalInput').value,
        activity: document.getElementById('activityInput').value,
        email: currentUser.email
    };
    
    if (!userProfile.name || !userProfile.weight || !userProfile.height) {
        alert('ุฃุฏุฎู ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ');
        return;
    }
    
    // ุญูุธ ุงูุจูุงูุงุช
    await db.collection('users').doc(currentUser.uid).set(userProfile, { merge: true });
    
    // ุนุฑุถ ุดุงุดุฉ ุงูุชุญููู
    showSection('loading');
    
    // ูุญุงูุงุฉ ูุฑุงุญู ุงูุชุญููู
    setTimeout(() => document.getElementById('step1').classList.remove('hidden'), 1000);
    setTimeout(() => document.getElementById('step2').classList.remove('hidden'), 2000);
    setTimeout(() => document.getElementById('step3').classList.remove('hidden'), 3000);
    
    // ุฅูุดุงุก ุงูุฎุทุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
    setTimeout(async () => {
        try {
            aiPlan = await createAIPlan(userProfile);
            showSection('results');
            displayPlan(aiPlan);
            addChatMessage('ai', 'ูุฑุญุจุงู! ุฃูุง ูุฏุฑุจู ุงูุฐูู. ููุฏ ุฃูุดุฃุช ูู ุฎุทุฉ ููุงูุฉ ูุฎุตุตุฉ. ููููู ุณุคุงูู ุนู ุฃู ุดูุก!');
        } catch (error) {
            alert('ุญุฏุซ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุฎุทุฉ. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            showSection('profile');
        }
    }, 4000);
}

async function createAIPlan(profile) {
    const prompt = `
ุฃูุช ุฎุจูุฑ ููุงูุฉ ุจุฏููุฉ ุนุฑุจู ูุญุชุฑู. ุฃูุดุฆ ุฎุทุฉ ููุงูุฉ ุดูุฑูุฉ (30 ููู) ููุดุฎุต ุงูุชุงูู:

ุงูุจูุงูุงุช:
- ุงูุงุณู: ${profile.name}
- ุงูุนูุฑ: ${profile.age} ุณูุฉ
- ุงููุฒู: ${profile.weight} ูุฌู
- ุงูุทูู: ${profile.height} ุณู
- ุงููุฏู: ${profile.goal === 'weight_loss' ? 'ุฎุณุงุฑุฉ ุงููุฒู' : profile.goal === 'muscle_gain' ? 'ุจูุงุก ุงูุนุถูุงุช' : 'ุชุญุณูู ุงูููุงูุฉ'}
- ุงููุดุงุท: ${profile.activity}

ุงููุทููุจ:
1. ุฎุทุฉ ุชูุงุฑูู ุฃุณุจูุนูุฉ ููุตูุฉ
2. ูุธุงู ุบุฐุงุฆู ูููู (ูุฌุจุงุชุ ุณุนุฑุงุชุ ุจุฑูุชูู)
3. ูุตุงุฆุญ ูููุฉ
4. ุฌุฏูู ูุชุงุจุนุฉ

ุฃุฌุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท.`;

    try {
        const response = await fetch('https://api.deepseek.com/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
            },
            body: JSON.stringify({
                model: 'deepseek-chat',
                messages: [
                    { role: 'system', content: 'ุฃูุช ุฎุจูุฑ ููุงูุฉ ุจุฏููุฉ ุนุฑุจู.' },
                    { role: 'user', content: prompt }
                ],
                temperature: 0.7,
                max_tokens: 2000
            })
        });
        
        const data = await response.json();
        const plan = data.choices[0].message.content;
        
        // ุญูุธ ุงูุฎุทุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        await db.collection('plans').doc(currentUser.uid).set({
            plan: plan,
            created: new Date(),
            profile: profile
        });
        
        return plan;
    } catch (error) {
        console.error('AI Error:', error);
        // ุฎุทุท ุงุญุชูุงุทูุฉ
        return getBackupPlan(profile);
    }
}

function getBackupPlan(profile) {
    const goals = {
        weight_loss: `
๐ฏ ุฎุทุฉ ุฎุณุงุฑุฉ ุงููุฒู - 30 ููู

๐๏ธโโ๏ธ ุงูุชูุงุฑูู ุงูุฃุณุจูุนูุฉ:
โข ุงูุฅุซููู: ูุงุฑุฏูู 45 ุฏูููุฉ
โข ุงูุซูุงุซุงุก: ุชูุงุฑูู ููุงููุฉ
โข ุงูุฃุฑุจุนุงุก: ูุงุฑุฏูู 30 ุฏูููุฉ
โข ุงูุฎููุณ: ุชูุงุฑูู ููุงููุฉ
โข ุงูุฌูุนุฉ: ูุงุฑุฏูู 45 ุฏูููุฉ
โข ุงูุณุจุช: ูุดู 60 ุฏูููุฉ
โข ุงูุฃุญุฏ: ุฑุงุญุฉ

๐ฝ๏ธ ุงููุธุงู ุงูุบุฐุงุฆู:
โข ุงููุทูุฑ: ุจูุถ + ุฎุถุงุฑ
โข ูุฌุจุฉ ุฎูููุฉ: ุชูุงุญ
โข ุงูุบุฏุงุก: ุฏุฌุงุฌ + ุณูุทุฉ
โข ูุฌุจุฉ ุฎูููุฉ: ุฒุจุงุฏู
โข ุงูุนุดุงุก: ุณูู + ุฎุถุงุฑ

๐ก ูุตุงุฆุญ:
1. ุงุดุฑุจ 3 ูุชุฑ ูุงุก ููููุงู
2. ุชุฌูุจ ุงูุณูุฑ
3. ูู 8 ุณุงุนุงุช
`,
        muscle_gain: `
๐ฏ ุฎุทุฉ ุจูุงุก ุงูุนุถูุงุช - 30 ููู

๐๏ธโโ๏ธ ุงูุชูุงุฑูู ุงูุฃุณุจูุนูุฉ:
โข ุงูุฅุซููู: ุงูุตุฏุฑ ูุงูุชุฑุงู
โข ุงูุซูุงุซุงุก: ุงูุธูุฑ ูุงูุจุงู
โข ุงูุฃุฑุจุนุงุก: ุงูุฃุฑุฌู
โข ุงูุฎููุณ: ุงูุฃูุชุงู
โข ุงูุฌูุนุฉ: ุงูุฐุฑุงุนูู
โข ุงูุณุจุช: ูุงุฑุฏูู ุฎููู
โข ุงูุฃุญุฏ: ุฑุงุญุฉ

๐ฝ๏ธ ุงููุธุงู ุงูุบุฐุงุฆู:
โข ุงููุทูุฑ: ุดููุงู + ุจูุถ
โข ูุฌุจุฉ ุฎูููุฉ: ุจุฑูุชูู ุดูู
โข ุงูุบุฏุงุก: ุฃุฑุฒ + ุฏุฌุงุฌ
โข ุจุนุฏ ุงูุชูุฑูู: ุจุฑูุชูู
โข ุงูุนุดุงุก: ุจุทุงุทุง ุญููุฉ + ูุญู

๐ก ูุตุงุฆุญ:
1. ูู ุจุฑูุชูู 2ุฌุฑุงู/ูุฌู
2. ุฒุฏ ุงูุฃูุฒุงู ุชุฏุฑูุฌูุงู
3. ุงุณุชุฑุญ ุจูู ุงูุชูุงุฑูู
`
    };
    
    return goals[profile.goal] || goals.muscle_gain;
}

// ========== DISPLAY PLAN ==========
function displayPlan(plan) {
    document.getElementById('aiPlan').innerHTML = `
        <div class="bg-white p-4 rounded-lg border border-gray-200">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold">๐ ุฎุทุชู ุงูุดูุฑูุฉ</h3>
                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                    ${new Date().toLocaleDateString('ar-EG')}
                </span>
            </div>
            <div class="whitespace-pre-line leading-relaxed">
                ${plan}
            </div>
        </div>
    `;
}

// ========== AI CHAT ==========
function addChatMessage(sender, message) {
    const chatDiv = document.getElementById('chatHistory');
    const messageDiv = document.createElement('div');
    messageDiv.className = sender === 'user' 
        ? 'bg-blue-100 p-3 rounded-lg ml-auto max-w-xs'
        : 'bg-green-100 p-3 rounded-lg mr-auto max-w-xs';
    
    messageDiv.innerHTML = `
        <div class="font-bold mb-1">${sender === 'user' ? '๐ค ุฃูุช' : '๐ค ุงูุฐูุงุก ุงูุงุตุทูุงุนู'}</div>
        <div>${message}</div>
    `;
    
    chatDiv.appendChild(messageDiv);
    chatDiv.scrollTop = chatDiv.scrollHeight;
}

async function askAI() {
    const question = document.getElementById('questionInput').value.trim();
    if (!question) return;
    
    // ุฅุถุงูุฉ ุณุคุงู ุงููุณุชุฎุฏู
    addChatMessage('user', question);
    document.getElementById('questionInput').value = '';
    
    try {
        const response = await fetch('https://api.deepseek.com/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
            },
            body: JSON.stringify({
                model: 'deepseek-chat',
                messages: [
                    { role: 'system', content: `ุฃูุช ูุฏุฑุจ ููุงูุฉ ุจุฏููุฉ ุนุฑุจู. ุงูุฎุทุฉ ุงูุญุงููุฉ: ${aiPlan.substring(0, 500)}...` },
                    { role: 'user', content: question }
                ],
                temperature: 0.7,
                max_tokens: 1000
            })
        });
        
        const data = await response.json();
        const answer = data.choices[0].message.content;
        addChatMessage('ai', answer);
    } catch (error) {
        addChatMessage('ai', 'ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
    }
}

// ========== UTILITIES ==========
function downloadPlan() {
    if (!aiPlan) return;
    
    const element = document.createElement('a');
    const file = new Blob([aiPlan], {type: 'text/plain'});
    element.href = URL.createObjectURL(file);
    element.download = `ุฎุทุฉ-ุงูููุงูุฉ-${userProfile.name || 'ุงููุณุชุฎุฏู'}.txt`;
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}

// ========== INITIALIZATION ==========
// ุงูุชุญูู ูู ุงูุนูู ุนูุฏ ุงูุชุญููู
window.onload = function() {
    console.log('โ ุงููููุน ูุนูู ุนูู GitHub Pages!');
};
</script>
</body>
</html>
